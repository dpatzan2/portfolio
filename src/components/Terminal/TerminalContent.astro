---
// Terminal Content Component - Simula una terminal Linux bÃ¡sica
import { profileData } from '../../data/profile';
---

<div class="terminal-container h-full flex flex-col bg-[#300a24] font-mono text-sm">
  <!-- Terminal Output -->
  <div id="terminal-output" class="flex-1 p-4 overflow-y-auto">
    <!-- Welcome Message -->
    <pre class="text-[#E95420] mb-4">
 ____  ____       _                  
|  _ \|  _ \ __ _| |_ ______ _ _ __  
| | | | |_) / _` | __|_  / _` | '_ \ 
| |_| |  __/ (_| | |_ / / (_| | | | |
|____/|_|   \__,_|\__/___\__,_|_| |_|
    </pre>
    <div class="text-green-400 mb-2">Â¡Bienvenido a la terminal de DPatzÃ¡n Portfolio!</div>
    <div class="text-gray-400 mb-4">Escribe 'help' para ver los comandos disponibles.</div>
  </div>
  
  <!-- Terminal Input -->
  <div class="flex items-center p-2 border-t border-white/10 bg-[#2c001e]">
    <span class="text-green-400 mr-2">guest@dpatzan:~$</span>
    <input 
      type="text" 
      id="terminal-input"
      class="flex-1 bg-transparent text-white outline-none caret-green-400"
      autocomplete="off"
      spellcheck="false"
      autofocus
    />
  </div>
</div>

<script define:vars={{ profileData }}>
  // Terminal State
  const commandHistory = [];
  let historyIndex = -1;
  let currentPath = '/home/guest';
  
  // DOM Elements
  const output = document.getElementById('terminal-output');
  const input = document.getElementById('terminal-input');
  const promptElement = document.querySelector('.terminal-container .text-green-400');
  
  // Virtual File System - Tree structure
  const fileSystem = {
    '/': {
      type: 'dir',
      children: {
        'home': {
          type: 'dir',
          children: {
            'guest': {
              type: 'dir',
              children: {
                'about.txt': {
                  type: 'file',
                  content: `Nombre: ${profileData.name}
CarnÃ©: ${profileData.carne}
Email: ${profileData.email}

${profileData.description.join('\n')}`
                },
                'skills.txt': {
                  type: 'file',
                  content: `=== Habilidades TÃ©cnicas ===
${profileData.skills.map(s => `â€¢ ${s.name}`).join('\n')}

=== Soft Skills ===
${profileData.softSkills.join(', ')}`
                },
                'contact.txt': {
                  type: 'file',
                  content: `ğŸ“§ Email: ${profileData.email}
ğŸ“ CarnÃ©: ${profileData.carne}
ğŸ« Universidad del Valle de Guatemala`
                },
                'projects': {
                  type: 'dir',
                  children: {
                    'README.md': {
                      type: 'file',
                      content: `# Proyectos
AquÃ­ encontrarÃ¡s mis proyectos mÃ¡s destacados.
Visita la ventana de Proyectos para mÃ¡s detalles.`
                    },
                    'portfolio': {
                      type: 'dir',
                      children: {
                        'info.txt': {
                          type: 'file',
                          content: 'Portfolio Ubuntu - Construido con Astro y TailwindCSS'
                        }
                      }
                    }
                  }
                },
                'documents': {
                  type: 'dir',
                  children: {
                    'cv.pdf': {
                      type: 'file',
                      content: '[Archivo PDF - Usa el visor de documentos para ver el CV]'
                    }
                  }
                },
                'downloads': {
                  type: 'dir',
                  children: {}
                }
              }
            }
          }
        }
      }
    }
  };

  // Helper: Get node from path
  function getNode(path) {
    if (path === '/') return fileSystem['/'];
    
    const parts = path.split('/').filter(p => p);
    let node = fileSystem['/'];
    
    for (const part of parts) {
      if (!node.children || !node.children[part]) {
        return null;
      }
      node = node.children[part];
    }
    return node;
  }

  // Helper: Resolve path (handle .., ., ~, relative paths)
  function resolvePath(pathArg) {
    let path = pathArg;
    
    // Handle home shortcut
    if (path === '~' || path.startsWith('~/')) {
      path = '/home/guest' + path.slice(1);
    }
    
    // Handle absolute vs relative
    if (!path.startsWith('/')) {
      path = currentPath + '/' + path;
    }
    
    // Normalize path (resolve . and ..)
    const parts = path.split('/').filter(p => p);
    const resolved = [];
    
    for (const part of parts) {
      if (part === '..') {
        resolved.pop();
      } else if (part !== '.') {
        resolved.push(part);
      }
    }
    
    return '/' + resolved.join('/');
  }

  // Helper: Get display path (shorten /home/guest to ~)
  function getDisplayPath(path) {
    if (path === '/home/guest') return '~';
    if (path.startsWith('/home/guest/')) return '~' + path.slice(11);
    return path;
  }

  // Update prompt
  function updatePrompt() {
    if (promptElement) {
      promptElement.textContent = `guest@dpatzan:${getDisplayPath(currentPath)}$ `;
    }
  }
  
  // Commands
  const commands = {
    help: () => `<span class="text-cyan-400">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="text-yellow-400">                     COMANDOS DISPONIBLES</span>
<span class="text-cyan-400">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

<span class="text-green-400">NAVEGACIÃ“N:</span>
  <span class="text-white">pwd</span>           - Muestra el directorio actual
  <span class="text-white">cd [dir]</span>      - Cambia de directorio
  <span class="text-white">ls [dir]</span>      - Lista archivos y directorios
  <span class="text-white">tree</span>          - Muestra estructura de directorios
  <span class="text-white">cat [file]</span>    - Muestra el contenido de un archivo
  <span class="text-white">cd [dir]</span>      - Cambia de directorio

<span class="text-green-400">INFORMACIÃ“N:</span>
  <span class="text-white">whoami</span>        - Muestra el usuario actual
  <span class="text-white">neofetch</span>      - Muestra informaciÃ³n del sistema
  <span class="text-white">uname [-a]</span>    - InformaciÃ³n del kernel
  <span class="text-white">uptime</span>        - Tiempo encendido
  <span class="text-white">date</span>          - Fecha y hora actual
  <span class="text-white">weather</span>       - Clima actual 
  <span class="text-white">social</span>        - Mis redes sociales

<span class="text-green-400">DIVERSIÃ“N:</span>
  <span class="text-white">fortune</span>       - Frase aleatoria de programaciÃ³n
  <span class="text-white">cowsay [msg]</span>  - Vaca que habla 
  <span class="text-white">joke</span>          - Chiste de programaciÃ³n
  <span class="text-white">matrix</span>        - Efecto Matrix (5 seg)
  <span class="text-white">sl</span>            - Tren sorpresa
  <span class="text-white">figlet [text]</span> - Texto ASCII art
  <span class="text-white">lolcat [text]</span> - Texto con colores

<span class="text-green-400">UTILIDADES:</span>
  <span class="text-white">echo [text]</span>   - Imprime texto
  <span class="text-white">clear</span>         - Limpia la terminal
  <span class="text-white">history</span>       - Historial de comandos
  <span class="text-white">man [cmd]</span>     - Manual de comandos
  <span class="text-white">calc [expr]</span>   - Calculadora
  <span class="text-white">hola</span>          - Saludo personalizado
  <span class="text-white">cafe</span>          - Hora de un cafÃ©

<span class="text-cyan-400">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="text-gray-400">Tip: Usa las flechas â†‘â†“ para navegar el historial</span>`,
    
    whoami: () => 'guest',
    
    pwd: () => currentPath,
    
    cd: (args) => {
      const target = args && args.length > 0 ? args[0] : '~';
      const newPath = resolvePath(target);
      const node = getNode(newPath);
      
      if (!node) {
        return `<span class="text-red-400">cd: ${target}: No existe el directorio</span>`;
      }
      if (node.type !== 'dir') {
        return `<span class="text-red-400">cd: ${target}: No es un directorio</span>`;
      }
      
      currentPath = newPath || '/';
      updatePrompt();
      
      // Visual confirmation of directory change
      const displayPath = getDisplayPath(currentPath);
      const itemCount = Object.keys(node.children || {}).length;
      return `<span class="text-cyan-400"> ${displayPath}</span> <span class="text-gray-500">(${itemCount} elemento${itemCount !== 1 ? 's' : ''})</span>`;
    },
    
    ls: (args) => {
      const target = args && args.length > 0 ? resolvePath(args[0]) : currentPath;
      const node = getNode(target);
      
      if (!node) {
        return `<span class="text-red-400">ls: ${args[0]}: No existe el directorio</span>`;
      }
      if (node.type !== 'dir') {
        return `<span class="text-white">${args[0]}</span>`;
      }
      
      const entries = Object.keys(node.children || {});
      if (entries.length === 0) {
        return '<span class="text-gray-500">(directorio vacÃ­o)</span>';
      }
      
      return entries.map(name => {
        const child = node.children[name];
        if (child.type === 'dir') {
          return `<span class="text-blue-400">${name}/</span>`;
        }
        return `<span class="text-white">${name}</span>`;
      }).join('  ');
    },

    tree: (args) => {
      const target = args && args.length > 0 ? resolvePath(args[0]) : currentPath;
      const node = getNode(target);
      
      if (!node || node.type !== 'dir') {
        return `<span class="text-red-400">tree: No se puede mostrar Ã¡rbol</span>`;
      }
      
      let output = `<span class="text-blue-400">${getDisplayPath(target)}</span>\n`;
      
      function buildTree(node, prefix = '') {
        const entries = Object.keys(node.children || {});
        entries.forEach((name, index) => {
          const isLast = index === entries.length - 1;
          const child = node.children[name];
          const connector = isLast ? 'â””â”€â”€ ' : 'â”œâ”€â”€ ';
          const color = child.type === 'dir' ? 'text-blue-400' : 'text-white';
          output += prefix + connector + `<span class="${color}">${name}${child.type === 'dir' ? '/' : ''}</span>\n`;
          
          if (child.type === 'dir') {
            buildTree(child, prefix + (isLast ? '    ' : 'â”‚   '));
          }
        });
      }
      
      buildTree(node);
      return output;
    },
    
    cat: (args) => {
      if (!args || args.length === 0) {
        return '<span class="text-red-400">cat: falta el operando archivo</span>';
      }
      
      const target = resolvePath(args[0]);
      const node = getNode(target);
      
      if (!node) {
        return `<span class="text-red-400">cat: ${args[0]}: No existe el archivo o directorio</span>`;
      }
      if (node.type === 'dir') {
        return `<span class="text-red-400">cat: ${args[0]}: Es un directorio</span>`;
      }
      
      return node.content;
    },
    
    clear: () => {
      output.innerHTML = '';
      return null;
    },
    
    date: () => new Date().toLocaleString('es-GT', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit'
    }),

    uptime: () => {
      const days = Math.floor(Math.random() * 365) + 1;
      const hours = Math.floor(Math.random() * 24);
      const mins = Math.floor(Math.random() * 60);
      return `<span class="text-green-400">â± Encendido:</span> ${days} dÃ­as, ${hours} horas, ${mins} minutos
<span class="text-gray-400">   Carga promedio: 0.42, 0.38, 0.35</span>`;
    },

    uname: (args) => {
      if (args && args[0] === '-a') {
        return 'Linux dpatzan-portfolio 6.5.0-astro #1 SMP PREEMPT_DYNAMIC Web x86_64 GNU/Linux';
      }
      return 'Linux';
    },

    weather: () => {
      const conditions = [
        { icon: 'â˜€ï¸', desc: 'Soleado', temp: '28Â°C' },
        { icon: 'ğŸŒ¤ï¸', desc: 'Parcialmente nublado', temp: '24Â°C' },
        { icon: 'â›…', desc: 'Nublado', temp: '22Â°C' },
        { icon: 'ğŸŒ§ï¸', desc: 'Lluvia ligera', temp: '18Â°C' },
        { icon: 'â›ˆï¸', desc: 'Tormenta', temp: '16Â°C' }
      ];
      const w = conditions[Math.floor(Math.random() * conditions.length)];
      return `<span class="text-cyan-400">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ${w.icon}  CLIMA EN GUATEMALA CITY      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CondiciÃ³n: ${w.desc.padEnd(20)}     â”‚
â”‚  Temperatura: ${w.temp.padEnd(18)}     â”‚
â”‚  Humedad: ${Math.floor(Math.random() * 40 + 50)}%                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span>`;
    },

    social: () => `<span class="text-cyan-400">
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸŒ REDES SOCIALES                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘   <span class="text-white"> Email:</span>     df.patzan@gmail.com                     â•‘
â•‘   <span class="text-white"> GitHub:</span>    github.com/dpatzan                       â•‘
â•‘   <span class="text-white"> LinkedIn:</span>  inkedin.com/in/diego-patz%C3%A1n-144b51255                  â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</span>`,
    
    echo: (args) => args ? args.join(' ') : '',

    fortune: () => {
      const fortunes = [
        '"El cÃ³digo que funciona es el mejor cÃ³digo." - Programador anÃ³nimo',
        '"Hay dos formas de escribir cÃ³digo: tan simple que no hay errores obvios, o tan complejo que no hay errores obvios." - C.A.R. Hoare',
        '"El debugging es como ser un detective en una pelÃ­cula de crimen donde tÃº tambiÃ©n eres el asesino." - Filipe Fortes',
        '"El mejor cÃ³digo es el que no escribes." - Jeff Atwood',
        '"Programar es como escribir un libro... excepto que si olvidas un punto y coma, el libro entero no funciona."',
        '"No soy un gran programador; solo soy un buen programador con grandes hÃ¡bitos." - Kent Beck',
        '"El cÃ³digo es poesÃ­a." - WordPress',
        '"Primero, resuelve el problema. Luego, escribe el cÃ³digo." - John Johnson',
        '"La simplicidad es la sofisticaciÃ³n definitiva." - Leonardo da Vinci',
        '"Los programadores no mueren, solo pierden su memoria." - AnÃ³nimo',
        '"Un buen programador es aquel que mira a ambos lados antes de cruzar una calle de un solo sentido." - Doug Linder',
        '"Si depurar es el proceso de eliminar bugs, entonces programar es el proceso de crearlos." - Edsger Dijkstra'
      ];
      const fortune = fortunes[Math.floor(Math.random() * fortunes.length)];
      return `<span class="text-yellow-400"> ${fortune}</span>`;
    },

    cowsay: (args) => {
      const message = args && args.length > 0 ? args.join(' ') : 'Moo! Hola desde el portfolio!';
      const msgLen = message.length;
      const border = '_'.repeat(msgLen + 2);
      const borderBottom = '-'.repeat(msgLen + 2);
      return `<span class="text-white"> ${border}
< ${message} >
 ${borderBottom}
        \\   ^__^
         \\  (oo)\\_______
            (__)\\       )\\/\\
                ||----w |
                ||     ||</span>`;
    },

    joke: () => {
      const jokes = [
        { q: 'Â¿Por quÃ© los programadores prefieren el frÃ­o?', a: 'Porque odian los bugs (insectos)!' },
        { q: 'Â¿CuÃ¡ntos programadores se necesitan para cambiar una bombilla?', a: 'Ninguno, es un problema de hardware.' },
        { q: 'Â¿Por quÃ© Java desarrollÃ³ depresiÃ³n?', a: 'Porque no tiene amigos, solo clases.' },
        { q: 'Â¿QuÃ© hace un programador cuando tiene hambre?', a: 'return comida;' },
        { q: 'Â¿Por quÃ© los programadores confunden Halloween con Navidad?', a: 'Porque OCT 31 = DEC 25 ' },
        { q: 'Â¿CuÃ¡l es la ciudad favorita de los programadores?', a: 'GitHub City ' },
        { q: 'Â¿Por quÃ© el desarrollador se fue a la oscuridad?', a: 'Porque tenÃ­a miedo de la luz (modo) ' },
        { q: 'Un SQL entra a un bar, se acerca a dos mesas y pregunta...', a: '"Â¿Puedo unirme?" (JOIN) ' }
      ];
      const joke = jokes[Math.floor(Math.random() * jokes.length)];
      return `<span class="text-green-400"> ${joke.q}</span>
<span class="text-yellow-400">   ${joke.a}</span>`;
    },

    matrix: () => {
      // Start matrix effect
      const chars = 'ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆãƒŠãƒ‹ãƒŒãƒãƒãƒãƒ’ãƒ•ãƒ˜ãƒ›ãƒãƒŸãƒ ãƒ¡ãƒ¢ãƒ¤ãƒ¦ãƒ¨ãƒ©ãƒªãƒ«ãƒ¬ãƒ­ãƒ¯ãƒ²ãƒ³0123456789';
      let matrixInterval;
      let count = 0;
      
      const createMatrixLine = () => {
        const line = document.createElement('div');
        line.className = 'text-green-400';
        let text = '';
        for (let i = 0; i < 60; i++) {
          text += chars[Math.floor(Math.random() * chars.length)];
        }
        line.textContent = text;
        output.appendChild(line);
        output.scrollTop = output.scrollHeight;
      };
      
      matrixInterval = setInterval(() => {
        createMatrixLine();
        count++;
        if (count > 30) {
          clearInterval(matrixInterval);
          addOutput('<span class="text-cyan-400">Wake up, Neo... La Matrix te tiene.</span>');
        }
      }, 150);
      
      return '<span class="text-green-400"> Iniciando Matrix...</span>';
    },

    sl: () => {
      const train = `<span class="text-white">
      ====        ________                ___________
  _D _|  |_______/        \\__I_I_____===__|_________|
   |(_)---  |   H\\________/ |   |        =|___ ___|   
   /     |  |   H  |  |     |   |         ||_| |_||   
  |      |  |   H  |__--------------------| [___] |   
  | ________|___H__/__|_____/[][]~\\_______|       |   
  |/ |   |-----------I_____I [][] []  D   |=======|__ 
__/ =| o |=-~~\\  /~~\\  /~~\\  /~~\\ ____Y___________|__ 
 |/-=|___|=   O=====O=====O=====O|_____/~\\___/        
  \\_/      \\__/  \\__/  \\__/  \\__/      \\_/            
</span>
<span class="text-yellow-400"> Â¡Chuu chuu! El tren ha pasado...</span>`;
      return train;
    },

    figlet: (args) => {
      const text = args && args.length > 0 ? args.join(' ').toUpperCase() : 'HELLO';
      const letters = {
        'A': ['  â–ˆ  ', ' â–ˆ â–ˆ ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ'],
        'B': ['â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ '],
        'C': [' â–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    ', 'â–ˆ    ', 'â–ˆ    ', ' â–ˆâ–ˆâ–ˆâ–ˆ'],
        'D': ['â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ '],
        'E': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    ', 'â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
        'F': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    ', 'â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    ', 'â–ˆ    '],
        'G': [' â–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    ', 'â–ˆ  â–ˆâ–ˆ', 'â–ˆ   â–ˆ', ' â–ˆâ–ˆâ–ˆâ–ˆ'],
        'H': ['â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ'],
        'I': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '  â–ˆ  ', '  â–ˆ  ', '  â–ˆ  ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
        'J': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '   â–ˆ ', '   â–ˆ ', 'â–ˆ  â–ˆ ', ' â–ˆâ–ˆ  '],
        'K': ['â–ˆ   â–ˆ', 'â–ˆ  â–ˆ ', 'â–ˆâ–ˆâ–ˆ  ', 'â–ˆ  â–ˆ ', 'â–ˆ   â–ˆ'],
        'L': ['â–ˆ    ', 'â–ˆ    ', 'â–ˆ    ', 'â–ˆ    ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
        'M': ['â–ˆ   â–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆ', 'â–ˆ â–ˆ â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ'],
        'N': ['â–ˆ   â–ˆ', 'â–ˆâ–ˆ  â–ˆ', 'â–ˆ â–ˆ â–ˆ', 'â–ˆ  â–ˆâ–ˆ', 'â–ˆ   â–ˆ'],
        'O': [' â–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', ' â–ˆâ–ˆâ–ˆ '],
        'P': ['â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ    ', 'â–ˆ    '],
        'Q': [' â–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆ â–ˆ â–ˆ', 'â–ˆ  â–ˆ ', ' â–ˆâ–ˆ â–ˆ'],
        'R': ['â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ ', 'â–ˆ  â–ˆ ', 'â–ˆ   â–ˆ'],
        'S': [' â–ˆâ–ˆâ–ˆâ–ˆ', 'â–ˆ    ', ' â–ˆâ–ˆâ–ˆ ', '    â–ˆ', 'â–ˆâ–ˆâ–ˆâ–ˆ '],
        'T': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '  â–ˆ  ', '  â–ˆ  ', '  â–ˆ  ', '  â–ˆ  '],
        'U': ['â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', ' â–ˆâ–ˆâ–ˆ '],
        'V': ['â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', ' â–ˆ â–ˆ ', '  â–ˆ  '],
        'W': ['â–ˆ   â–ˆ', 'â–ˆ   â–ˆ', 'â–ˆ â–ˆ â–ˆ', 'â–ˆâ–ˆ â–ˆâ–ˆ', 'â–ˆ   â–ˆ'],
        'X': ['â–ˆ   â–ˆ', ' â–ˆ â–ˆ ', '  â–ˆ  ', ' â–ˆ â–ˆ ', 'â–ˆ   â–ˆ'],
        'Y': ['â–ˆ   â–ˆ', ' â–ˆ â–ˆ ', '  â–ˆ  ', '  â–ˆ  ', '  â–ˆ  '],
        'Z': ['â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ', '   â–ˆ ', '  â–ˆ  ', ' â–ˆ   ', 'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ'],
        ' ': ['     ', '     ', '     ', '     ', '     '],
        '!': ['  â–ˆ  ', '  â–ˆ  ', '  â–ˆ  ', '     ', '  â–ˆ  '],
        '?': [' â–ˆâ–ˆâ–ˆ ', 'â–ˆ   â–ˆ', '  â–ˆâ–ˆ ', '     ', '  â–ˆ  '],
      };
      
      let result = ['', '', '', '', ''];
      for (const char of text.slice(0, 10)) {
        const letter = letters[char] || letters[' '];
        for (let i = 0; i < 5; i++) {
          result[i] += letter[i] + ' ';
        }
      }
      
      return `<span class="text-[#E95420]">${result.join('\n')}</span>`;
    },

    lolcat: (args) => {
      const text = args && args.length > 0 ? args.join(' ') : 'Rainbow Text!';
      const colors = ['text-red-400', 'text-orange-400', 'text-yellow-400', 'text-green-400', 'text-cyan-400', 'text-blue-400', 'text-purple-400'];
      
      let result = '';
      for (let i = 0; i < text.length; i++) {
        const color = colors[i % colors.length];
        result += `<span class="${color}">${text[i]}</span>`;
      }
      return result;
    },

    calc: (args) => {
      if (!args || args.length === 0) {
        return '<span class="text-gray-400">Uso: calc [expresiÃ³n]  Ejemplo: calc 2+2*3</span>';
      }
      try {
        const expr = args.join('').replace(/[^0-9+\-*/().]/g, '');
        const result = Function('"use strict"; return (' + expr + ')')();
        return `<span class="text-green-400"> ${args.join(' ')} = ${result}</span>`;
      } catch (e) {
        return '<span class="text-red-400">Error: ExpresiÃ³n invÃ¡lida</span>';
      }
    },

    man: (args) => {
      if (!args || args.length === 0) {
        return '<span class="text-gray-400">Uso: man [comando]</span>';
      }
      const manuals = {
        ls: 'ls - lista el contenido del directorio\n\nUSO: ls [directorio]\n\nLista informaciÃ³n sobre los archivos y directorios.',
        cd: 'cd - cambia el directorio de trabajo\n\nUSO: cd [directorio]\n\nCambia el directorio actual al especificado. Usa ~ para ir al home.',
        cat: 'cat - concatena y muestra archivos\n\nUSO: cat [archivo]\n\nMuestra el contenido de un archivo de texto.',
        cowsay: 'cowsay - genera una vaca ASCII que habla\n\nUSO: cowsay [mensaje]\n\nMuestra una vaca diciendo el mensaje proporcionado.',
        fortune: 'fortune - muestra una frase aleatoria\n\nUSO: fortune\n\nMuestra frases de programaciÃ³n aleatorias.',
        matrix: 'matrix - efecto Matrix\n\nUSO: matrix\n\nMuestra el efecto de lluvia de caracteres de Matrix.',
        figlet: 'figlet - texto ASCII art\n\nUSO: figlet [texto]\n\nConvierte texto a arte ASCII.'
      };
      
      const cmd = args[0].toLowerCase();
      if (manuals[cmd]) {
        return `<span class="text-yellow-400">${manuals[cmd]}</span>`;
      }
      return `<span class="text-red-400">No hay manual para '${cmd}'</span>`;
    },

    hola: () => {
      const hour = new Date().getHours();
      let greeting = '';
      if (hour < 12) greeting = 'Â¡Buenos dÃ­as! ';
      else if (hour < 18) greeting = 'Â¡Buenas tardes! ';
      else greeting = 'Â¡Buenas noches! ';
      
      return `<span class="text-cyan-400">${greeting}</span>
<span class="text-white">Soy Diego PatzÃ¡n, desarrollador web apasionado.</span>
<span class="text-gray-400">Gracias por visitar mi portfolio. Â¡Explora con los comandos!</span>`;
    },

    cafe: () => {
      return `<span class="text-yellow-600">
         {
      {   }
       }_{ __{
    .-{   }   }-.
   (   }     {   )
   |\`-.._____..-'|
   |             ;--.
   |            (__  \\
   |             | )  )
   |             |/  /
   |             /  /
   |            (  /
   \\             y'
    \`-.._____..-'
</span>
<span class="text-white">Â¡Hora de un cafÃ©! El combustible de todo programador.</span>`;
    },
    
    neofetch: () => `<span class="text-[#E95420]">       _,met$$$$$gg.           </span><span class="text-white">guest@dpatzan</span>
<span class="text-[#E95420]">    ,g$$$$$$$$$$$$$$$P.        </span><span class="text-white">--------------</span>
<span class="text-[#E95420]">  ,g$$P""       """Y$$.".      </span><span class="text-[#E95420]">OS:</span> Ubuntu Portfolio 24.04 LTS
<span class="text-[#E95420]"> ,$$P'              \`$$$.     </span><span class="text-[#E95420]">Host:</span> ${profileData.name}
<span class="text-[#E95420]">',$$P       ,ggs.     \`$$b:   </span><span class="text-[#E95420]">Kernel:</span> Astro 5.x
<span class="text-[#E95420]">\`d$$'     ,$P"'   .    $$$    </span><span class="text-[#E95420]">Uptime:</span> ${Math.floor(Math.random() * 30) + 1} dÃ­as
<span class="text-[#E95420]"> $$P      d$'     ,    $$P    </span><span class="text-[#E95420]">Shell:</span> bash 5.1.16
<span class="text-[#E95420]"> $$:      $$.   -    ,d$$'    </span><span class="text-[#E95420]">Terminal:</span> portfolio-term
<span class="text-[#E95420]"> $$;      Y$b._   _,d$P'      </span><span class="text-[#E95420]">CPU:</span> JavaScript Engine @ 100%
<span class="text-[#E95420]"> Y$$.    \`.\`"Y$$$$P"'         </span><span class="text-[#E95420]">Memory:</span> 1337MB / âˆMB
<span class="text-[#E95420]"> \`$$b      "-.__              </span><span class="text-[#E95420]">Skills:</span> ${profileData.skills.length} tecnologÃ­as
<span class="text-[#E95420]">  \`Y$$                        </span>
<span class="text-[#E95420]">   \`Y$$.                      </span><span style="background:#E95420" class="px-2">  </span><span style="background:#77216F" class="px-2">  </span><span style="background:#5E2750" class="px-2">  </span><span style="background:#2C001E" class="px-2">  </span>
<span class="text-[#E95420]">     \`$$b.                    </span>
<span class="text-[#E95420]">       \`Y$$b.                 </span>
<span class="text-[#E95420]">          \`"Y$b._             </span>`,
    
    history: () => {
      if (commandHistory.length === 0) return 'Historial vacÃ­o';
      return commandHistory.map((cmd, i) => `  ${i + 1}  ${cmd}`).join('\n');
    },
    
    mkdir: (args) => {
      if (!args || args.length === 0) {
        return '<span class="text-red-400">mkdir: falta el operando</span>';
      }
      return `<span class="text-yellow-400">mkdir: OperaciÃ³n no permitida - Este portfolio es de solo lectura</span>`;
    },
    
    touch: (args) => {
      return `<span class="text-yellow-400">touch: OperaciÃ³n no permitida - Este portfolio es de solo lectura</span>`;
    },
    
    sudo: (args) => {
      if (args && args.length > 0 && args[0] === 'rm' && args.includes('-rf') && args.includes('/')) {
        return `<span class="text-red-400"> Â¡ALTO AHÃ! No destruyas mi portfolio </span>`;
      }
      return `<span class="text-red-400">sudo: No tienes permisos de superusuario en este portfolio 
<span class="text-gray-400">Pero si quieres, puedes contactarme para colaborar!</span></span>`;
    },
    
    rm: (args) => {
      if (args && args.includes('-rf')) {
        return `<span class="text-red-400"> Â¡Hey! Este portfolio tiene protecciÃ³n anti-destrucciÃ³n activada.</span>`;
      }
      return `<span class="text-red-400">rm: OperaciÃ³n no permitida - Este portfolio es de solo lectura</span>`;
    },
    
    exit: () => {
      addOutput('<span class="text-yellow-400">Â¡Hasta pronto! Cierra la ventana para salir.</span>');
      return null;
    },

    vim: () => '<span class="text-yellow-400">vim: Â¿CÃ³mo salir de vim?  Pista: :q! (Es broma, no hay vim aquÃ­)</span>',
    
    nano: () => '<span class="text-gray-400">nano: Editor no disponible. Este portfolio es de solo lectura.</span>',

    ping: (args) => {
      if (!args || args.length === 0) {
        return '<span class="text-gray-400">Uso: ping [host]</span>';
      }
      return `PING ${args[0]} (127.0.0.1): 56 data bytes
64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.042 ms
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.039 ms
64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.041 ms
--- ${args[0]} ping statistics ---
3 packets transmitted, 3 received, 0% packet loss`;
    },

    git: (args) => {
      if (!args || args.length === 0) {
        return '<span class="text-gray-400">Git estÃ¡ disponible. Comandos: git status, git log</span>';
      }
      if (args[0] === 'status') {
        return `<span class="text-green-400">En rama main
Tu rama estÃ¡ actualizada con 'origin/main'.

nada para hacer commit, el Ã¡rbol de trabajo estÃ¡ limpio</span>`;
      }
      if (args[0] === 'log') {
        return `<span class="text-yellow-400">commit a1b2c3d4e5f6...</span>
Author: Diego PatzÃ¡n <df.patzan@gmail.com>
Date:   ${new Date().toDateString()}

    ğŸš€ Portfolio actualizado`;
      }
      return `<span class="text-gray-400">git: '${args[0]}' no es un comando git</span>`;
    },

    npm: (args) => {
      if (args && args[0] === 'install') {
        return `<span class="text-yellow-400"> Instalando paquetes...</span>
added 1337 packages in 3.14s
<span class="text-green-400"> Â¡InstalaciÃ³n completada!</span>`;
      }
      return '<span class="text-gray-400">npm: gestor de paquetes de Node.js</span>';
    }
  };
  
  // Add output line
  function addOutput(html, isCommand = false) {
    if (html === null) return;
    const div = document.createElement('div');
    div.className = isCommand ? 'text-white mb-1' : 'mb-2 whitespace-pre-wrap';
    div.innerHTML = html;
    output.appendChild(div);
    output.scrollTop = output.scrollHeight;
  }
  
  // Process command
  function processCommand(cmdLine) {
    const trimmed = cmdLine.trim();
    if (!trimmed) return;
    
    // Add to history
    commandHistory.push(trimmed);
    historyIndex = commandHistory.length;
    
    // Show command with current path
    addOutput(`<span class="text-green-400">guest@dpatzan:${getDisplayPath(currentPath)}$</span> ${trimmed}`, true);
    
    // Parse command
    const parts = trimmed.split(/\s+/);
    const cmd = parts[0].toLowerCase();
    const args = parts.slice(1);
    
    // Execute
    if (commands[cmd]) {
      const result = commands[cmd](args);
      if (result !== null) {
        addOutput(result);
      }
    } else {
      addOutput(`<span class="text-red-400">${cmd}: comando no encontrado. Escribe 'help' para ver comandos disponibles.</span>`);
    }
  }
  
  // Event listeners
  input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      processCommand(input.value);
      input.value = '';
    } else if (e.key === 'ArrowUp') {
      e.preventDefault();
      if (historyIndex > 0) {
        historyIndex--;
        input.value = commandHistory[historyIndex];
      }
    } else if (e.key === 'ArrowDown') {
      e.preventDefault();
      if (historyIndex < commandHistory.length - 1) {
        historyIndex++;
        input.value = commandHistory[historyIndex];
      } else {
        historyIndex = commandHistory.length;
        input.value = '';
      }
    } else if (e.key === 'l' && e.ctrlKey) {
      e.preventDefault();
      commands.clear();
    }
  });
  
  // Focus input when clicking on terminal
  document.querySelector('.terminal-container').addEventListener('click', () => {
    input.focus();
  });
</script>

<style>
  .terminal-container {
    font-family: 'Ubuntu Mono', 'Fira Code', 'Consolas', monospace;
  }
  
  #terminal-output::-webkit-scrollbar {
    width: 8px;
  }
  
  #terminal-output::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
  }
  
  #terminal-output::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
  }
  
  #terminal-output::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.3);
  }
  
  pre {
    font-size: 10px;
    line-height: 1.2;
  }
  
  @media (min-width: 768px) {
    pre {
      font-size: 12px;
    }
  }
</style>
